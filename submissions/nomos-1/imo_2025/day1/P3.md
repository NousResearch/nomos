# P3

## Problem

A function \(f:\mathbb{N}\to\mathbb{N}\) is said to be **bonza** if
\[
f(a) \mid \bigl(b^{a} - f(b)^{\,f(a)}\bigr)
\]
for all positive integers \(a\) and \(b\).

Determine the smallest real constant \(c\) such that
\[
f(n) \le cn
\]
for all bonza functions \(f\) and all positive integers \(n\).

## Submission

We prove that the smallest such constant is \(c=4\).

---

### 1.  Basic observations

Set \(a=b=1\):  
\(f(1)\mid 1^{1}-f(1)^{f(1)\) implies \(f(1)\mid 1-f(1)^{f(1)\).  Since \(f(1)\mid f(1)^{f(1)\), we obtain \(f(1)\mid 1\), hence  
\[
f(1)=1.
\]

Set \(a=b=2\):  
\(f(2)\mid 2^{2}-f(2)^{f(2)=4-f(2)^{f(2)\).  As \(f(2)\mid f(2)^{f(2)\), we get \(f(2)\mid 4\).  Thus  
\[
f(2)\in\{1,2,4\}.
\]

---

### 2.  Determining \(f(3)\)

From \(a=b=3\) we have \(f(3)\mid 27\), so \(f(3)\in\{1,3,9,27\}\).  We show that only \(f(3)=1\) is possible.

* **Case \(f(2)=1\).**  
  The condition \(a=3,\;b=2\) gives \(f(3)\mid 8-1^{f(3)=7\), so \(f(3)=1\).

* **Case \(f(2)=4\).**  
  Now \(a=3,\;b=2\): \(f(3)\mid 8-4^{f(3)\).  
  - \(f(3)=3\) gives \(8-64=-56\) not divisible by \(3\).  
  - \(f(3)=9\) gives \(8-4^{9}\) not divisible by \(9\).  
  - \(f(3)=27\) gives \(8-4^{27}\equiv 8-1=7\pmod{27}\), not divisible.  
  Hence \(f(3)=1\).

* **Case \(f(2)=2\).**  
  Then \(a=3,\;b=2\): \(f(3)\mid 8-2^{f(3)\).  
  - \(f(3)=3\) works (\(8-8=0\)).  
  - \(f(3)=9\) works (\(8-512=-504=-9\cdot56\)).  
  - \(f(3)=27\) fails (\(8-2^{27}\equiv 8-1=7\pmod{27}\)).  
  So \(f(3)\) could be \(3\) or \(9\).  

  *If \(f(3)=3\):*  
  Use \(a=3,\;b=4\): \(f(3)\mid 64-f(4)^{3}\).  Since \(f(4)\mid 256\), we test all divisors of \(256\) and find that none satisfy also \(a=4,\;b=3\) (\(f(4)\mid 27-3^{f(4)\)).  Indeed, for any divisor \(d\) of \(256\) the congruence \(64\equiv d^{3}\pmod{3}\) forces \(d\equiv1\pmod3\); the only divisors of \(256\) with that property are \(1,4,16,256\), but none satisfy \(d\mid 27-3^{d}\).  Contradiction.  

  *If \(f(3)=9\):*  
  \(a=3,\;b=4\): \(9\mid 64-f(4)^{9}\).  Powers of \(2\) modulo \(9\) are \(1\) only for \(f(4)\equiv4,16,64,256\).  For these, \(a=4,\;b=3\) gives \(f(4)\mid 27-9^{f(4)\).  None work (e.g. \(f(4)=4\) gives \(27-81=-54\) not divisible by \(4\); \(f(4)=16\) gives \(27-9^{16}\equiv26\pmod{16}\); \(f(4)=64\) fails \(a=4,\;b=2\); \(f(4)=256\) fails \(a=4,\;b=2\)).  Contradiction.

Thus in all cases \(f(3)=1\).

---

### 3.  \(f(a)\) is a power of \(2\)

Assume an odd prime \(p\) divides \(f(a)\).  Because \(f(a)\mid a^{a}\), we have \(p\mid a\).  Take \(b=p\) in the defining relation:  
\[
f(a)\mid p^{a}-f(p)^{f(a)}.
\]  
Since \(p\mid f(a)\), we get \(p\mid p^{a}-f(p)^{f(a)}\).  Because \(p\mid p^{a}\), it follows \(p\mid f(p)^{f(a)}\), hence \(p\mid f(p)\).  

Now from \(a=p,\;b=3\) and \(f(3)=1\) we have \(f(p)\mid 3^{p}-1\).  Therefore \(p\mid 3^{p}-1\).  By Fermat’s little theorem, \(3^{p}\equiv3\pmod p\), so \(3^{p}-1\equiv2\pmod p\).  Thus \(p\mid2\), impossible.  Consequently no odd prime can divide \(f(a)\); therefore \(f(a)\) is a power of \(2\):
\[
f(a)=2^{e(a)}\qquad (e(a)\in\mathbb{N}_{0,\;e(1)=0).
\]

---

### 4.  Upper bound \(f(n)\le 4n\)

From \(a=n,\;b=3\) and \(f(3)=1\) we obtain \(2^{e(n)}\mid 3^{n}-1\).  Hence \(e(n)\le v_{2}(3^{n}-1)\).

* If \(n\) is odd, \(3^{n}\equiv3\pmod4\), so \(v_{2}(3^{n}-1)=1\); thus \(f(n)\le2\).  
* If \(n\) is even, write \(n=2^{k}\cdot m\) with \(k\ge1\) and \(m\) odd.  Using LTE,
\[
v_{2}(3^{2^{k}-1)=k+2,\qquad v_{2}\big((3^{2^{k})^{m}-1\big)=v_{2}(3^{2^{k}-1)+v_{2}(m)=k+2,
\]
because \(m\) is odd.  Hence \(v_{2}(3^{n}-1)=k+2=2+v_{2}(n)\).  Consequently \(e(n)\le2+v_{2}(n)\) and
\[
f(n)=2^{e(n)}\le 2^{2+v_{2}(n)}=4\cdot2^{v_{2}(n)}.
\]

For any integer \(n\) we have \(2^{v_{2}(n)}\le n\) (since \(n=2^{v_{2}(n)}\cdot\text{odd}\)).  Therefore  
\[
f(n)\le 4\cdot2^{v_{2}(n)}\le 4n.
\]  
(The case \(n=2\) gives \(f(2)\le4\le8=4\cdot2\), so the inequality holds as well.)

---

### 5.  Sharpness of \(c=4\)

Define a function \(f:\mathbb{N}\to\mathbb{N}\) by  
\[
f(1)=1,\quad f(2)=4,
\]  
and for \(n\ge3\):  
\[
f(n)=\begin{cases}
1, & n\text{ odd},\\[2mm]
2^{v_{2}(n)+2}=4\cdot2^{v_{2}(n)}, & n\text{ even}.
\end{cases}
\]
(For \(n=2\) the formula would give \(8\), so we treat it separately.)

We verify that this \(f\) satisfies the condition \(f(a)\mid b^{a}-f(b)^{f(a)}\) for all \(a,b\).

* If \(a\) is odd, \(f(a)=1\) – trivial.  
* If \(a=2\), \(f(2)=4\).  
  - \(b=1\): \(4\mid 1-1=0\).  
  - \(b=2\): \(4\mid 4-4^{4}=-252\).  
  - \(b\) odd: \(b^{2}\equiv1\pmod4\) so \(4\mid b^{2}-1\).  
  - \(b\) even: \(b^{2}\) is a multiple of \(4\) and \(f(b)^{4}\) is a multiple of \(16\), hence \(4\mid b^{2}-f(b)^{4}\).  

* Now let \(a\) be even and \(a>2\).  Write \(a=2^{k}\cdot u\) with \(k\ge1\) and \(u\) odd.  Then \(f(a)=2^{k+2}\).  
  - **\(b\) odd:** \(f(b)=1\).  Since any odd number to the power \(2^{k}\) is \(\equiv1\pmod{2^{k+2}\) (the multiplicative group modulo \(2^{k+2}\) has exponent \(2^{k}\)), we have \(b^{a}\equiv1\pmod{2^{k+2}\); thus \(2^{k+2}\mid b^{a}-1\).  
  - **\(b=2\):** \(f(b)=4\).  Both \(2^{a}\) and \(4^{2^{k+2}=2^{2^{k+3}\) are multiples of \(2^{k+2}\), so their difference is divisible by \(2^{k+2}\).  
  - **\(b\) even, \(b>2\):** write \(b=2^{t}\cdot v\) (\(t\ge1,\;v\) odd).  Then \(f(b)=2^{t+2}\).  Then  
    \[
    b^{a}=2^{ta}\cdot v^{a},\qquad f(b)^{f(a)}=\big(2^{t+2}\big)^{2^{k+2}}=2^{(t+2)2^{k+2}}.
    \]
    Both terms are multiples of \(2^{k+2}\) because \(ta\ge t\cdot2^{k}\ge2^{k}\ge k+2\) for \(a\ge4\) (and for \(a=6,10,\dots\) the inequality also holds).  Hence their difference is divisible by \(2^{k+2}\).  

All cases are covered, so the function is bonza.  For \(a=4\) we have \(f(4)=16=4\cdot4\); thus the constant \(4\) cannot be lowered.

---

### 6.  Conclusion

We have shown \(f(n)\le 4n\) for every bonza function, and the constructed function shows that no smaller constant works.  Therefore the smallest real constant is

\[
\boxed{4}.
\]
