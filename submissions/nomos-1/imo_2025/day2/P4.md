# P4

## Problem

An infinite sequence \(a_1,a_2,\dots\) consists of positive integers each of which has at least three proper divisors. Suppose that for each \(n \ge 1\),
\[
a_{n+1} = \text{(sum of the three largest proper divisors of } a_n).
\]
Determine all possible values of \(a_1\).

## Submission

Let $a_1,a_2,\dots$ be an infinite sequence of positive integers, each having at least three proper divisors, and for each $n\ge 1$
\[
a_{n+1}=\text{sum of the three largest proper divisors of }a_n.
\]

For any integer $m>1$ with at least three proper divisors, let $d_1<d_2<d_3$ be the three smallest divisors of $m$ greater than $1$.  
Because the map $d\mapsto m/d$ sends divisors $>1$ bijectively onto proper divisors, the three largest proper divisors are $m/d_1,m/d_2,m/d_3$. Hence
\[
a_{n+1}=a_n\left(\frac1{d_1}+\frac1{d_2}+\frac1{d_3}\right). \tag{1}
\]

---
### 1.  Parity and divisibility by $3$

If $a_n$ is odd, then $d_1\ge3$, $d_2\ge5$, $d_3\ge7$, so $\frac1{d_1}+\frac1{d_2}+\frac1{d_3}\le\frac13+\frac15+\frac17<1$; thus $a_{n+1}<a_n$.  
Moreover $a_{n+1$ is odd (sum of three odd numbers).  Hence an odd starting term would give an infinite strictly decreasing sequence of odd numbers, impossible.  Therefore $a_1$ is even.

If $a_n$ is even but $3\nmid a_n$, then $d_1=2$, $d_2\ge4$, $d_3\ge5$, and $\frac12+\frac14+\frac15<1$, so $a_{n+1}<a_n$ again.  The sequence would be strictly decreasing, contradicting infiniteness.  Consequently $3\mid a_1$.

Thus $a_1$ is divisible by $6$.  Write
\[
a_1=2^\alpha 3^\beta\gamma,\qquad \alpha,\beta\ge1,\ \gamma\text{ odd},\ \gcd(\gamma,6)=1.
\]

---
### 2.  The case $\alpha=1$

If $\alpha=1$ then $4\nmid a_1$.  
* If $5\nmid\gamma$, the three smallest divisors are $2,3,6$, so by (1) $a_2=a_1$; the sequence is constant and works.  
* If $5\mid\gamma$, then the three smallest divisors are $2,3,5$ and $a_2=31\gamma$, which is odd.  By the odd case this leads to a contradiction.  
Hence for $\alpha=1$ we must have $5\nmid\gamma$.

---
### 3.  The case $\alpha\ge2$

Now $4\mid a_1$, so $d_1=2$, $d_2=3$, $d_3=4$ and
\[
a_2=\frac{13}{12}a_1. \tag{2}
\]

Let $t$ be the greatest integer with $12^t\mid a_1$.  For $i=1,\dots,t$, $a_i$ is divisible by $12$ and by (2) we have $a_{i+1}=\frac{13}{12}a_i$.  Consequently
\[
a_{t+1}=13^t\cdot\frac{a_1}{12^t}=:\,b.
\]
Set $a_1=12^t c$ with $c=2^{\alpha-2t}3^{\beta-t}\gamma$.  Because $c$ is not divisible by $12$, either $4\nmid c$ or $3\nmid c$.

* If $3\nmid c$, then $b$ is not divisible by $3$.  If also $4\mid c$, $b$ is even but not divisible by $3$ – impossible by the even‑not‑$3$ case.  If $4\nmid c$, $b$ is odd – impossible by the odd case.  
* Hence $3\mid c$ and $4\nmid c$.

$4\nmid c$ forces $\alpha-2t\le1$.  If $\alpha-2t=0$, then $c$ is odd and $b$ is odd – impossible.  Thus $\alpha-2t=1$, i.e. $\alpha$ is odd.  Then $c=2\cdot3^{\beta-t}\gamma$ and $\beta-t\ge1$.

Now $b=2\cdot3^{\beta-t}\cdot13^t\gamma$.  If $5\mid\gamma$, then $5\mid b$; but then $5<6$ and the three smallest divisors of $b$ become $2,3,5$, giving $a_{t+2}=31b/30$, which is odd and fails.  So $5\nmid\gamma$.

Under $5\nmid\gamma$, $b$ is even, divisible by $3$, not divisible by $4$, and $5\nmid b$; its three smallest divisors are $2,3,6$, therefore $b$ is a fixed point.  The sequence stabilises from $b$ onward.

From $\alpha-2t=1$ we obtain $t=\frac{\alpha-1}{2}$ and $\beta\ge t+1=\frac{\alpha+1}{2}$.  Hence the conditions for this case are
\[
\alpha\text{ odd},\qquad \beta\ge\frac{\alpha+1}{2},\qquad 5\nmid\gamma.
\]

---
### 4.  Recapitulation

The conditions derived are necessary and sufficient:

* $\alpha$ is odd,
* $\beta\ge\dfrac{\alpha+1}{2}$,
* $5\nmid\gamma$.

In prime factorisation this means $a_1=2^{2k+1}3^{\ell}m$ with $k\ge0$, $\ell\ge k+1$, and $m$ a positive integer coprime to $30$ (i.e. odd and not divisible by $5$).  
Every such number (and only those) yields an infinite sequence: it is either fixed (when $\alpha=1$) or after $\frac{\alpha-1}{2}$ steps reaches a fixed point $2\cdot3^{\beta-\frac{\alpha-1}{2}\cdot13^{\frac{\alpha-1}{2}\gamma$.

Therefore the set of all possible $a_1$ is
\[
\boxed{a_1=2^{2k+1}\,3^{\ell}\,m\quad\text{with}\quad k\ge0,\ \ell\ge k+1,\ \gcd(m,30)=1.}
\]
